<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Latest compiled JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
        integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="./style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <title>Emp_Leaves</title>
</head>

<body>
    <div class="sidebar">
        <div  style="padding: 14% ">
          <img src="./images/cache-cloudFont334.png" style="width: 90%;">
        </div>
        <!-- <i class="fa fa-fw fa-home"></i> -->
        <a class="active" href="./home.html">Home</a>
        <a href="./Emp_About.html">About</a>
          
        <a href class="btn  dropdown-toggle" data-bs-toggle="dropdown">Departments </a>
        <li class="dropdown-menu">
          <a class="dropdown-item" href="">Administration</a>
          <a class="dropdown-item" href="./soft_dep.html">Software Department</a>
          <a class="dropdown-item" href="./qa_dep.html">QA Department</a>
          <a class="dropdown-item" href="./oracle_data.html">DB Department</a>
          <a class="dropdown-item" href="./devOps.html">DevOps Department</a>
        </li>
        <a href class="btn  dropdown-toggle" data-bs-toggle="dropdown">CC Employees </a>
        <li class="dropdown-menu">
          <a class="dropdown-item" href="./emp_personal_Information.html">Add Emp Data</a>
          <a class="dropdown-item" href="./Employees.html">Emp Info</a>
          <a class="dropdown-item" href="./Emp_Cards.html">Emp Cards</a>
        </li>
        <a href class="btn  dropdown-toggle" data-bs-toggle="dropdown">Payroll System </a>
        <li class="dropdown-menu">
          <a class="dropdown-item" href="https://alfalahtransact.bankalfalah.com/SSO_FW/MasterPage/Home.aspx">Transation</a>
          <a class="dropdown-item" href="./salary.html">Salary Slips</a>
          <a class="dropdown-item" href="./medical_Allowance.html">Medical Allowance</a>
          <a class="dropdown-item" href="./advance_loan.html">Advance Loan</a>
          <a class="dropdown-item" href="./myCaal.html">Calculate</a>
        </li>
        <a href class="btn  dropdown-toggle" data-bs-toggle="dropdown">Leaves Chart </a>
        <li class="dropdown-menu">
          <a class="dropdown-item" href="./CC Attendance.html">Attendence Sheet</a>
          <a class="dropdown-item" href="./Emp_leaves.html">Leaves</a>
        </li>
        <a href class="btn  dropdown-toggle" data-bs-toggle="dropdown">Office Glossary  </a>
        <li class="dropdown-menu">
          <a class="dropdown-item" href="./expenses.html">Office Empenses</a>
          <a class="dropdown-item" href="./Accessories.html">Office Accessories</a>
          <a class="dropdown-item" href=""></a>
          <a class="dropdown-item" href=""></a>
          <!-- <hr style="border-bottom: 2px orange;"> -->
        </li>
        <a href="#">Emails</a>
        <!-- <a href="https://mail.google.com/mail/u/1/#inbox">CC Academy</a> -->
        <a href="">Entertainment</a>
        
        <div class="mar_log text-center ">
          <button type="button" class="btn log_out " onclick="myLogout()">Logout</button>
      </div>
      </div>
    <br>
    <br>
    <div class="container bg-white" style="border: none;">
        <h1 class="text-center cache-cloud">CACHE CLOUD HRM</h1>
        <br>
        <p>Director</p>
        <p>Ali Bajwa</p>
        <p>HR</p>
        <p>Faisal Mahmood</p>
    </div>
    <div class="container mt-5 p-5">
        <h3 class="text-center mt-5 mb-5">Employees Leaves Chart</h3>
        <div class="row">
            <div class="col"></div>
            <div class="col-md-4">
                <label for="fname"><i class="fa fa-user"></i> Name</label>
                <input type="text" id="name" name="firstname" placeholder="Enter Name" class="form-control">
            </div>
            <div class="col-md-4">
                <label for="fname"><i class="fa fa-user"></i>Sick leaves</label>
                <input type="number" id="s_Leaves" name="firstname" placeholder="Enter Sick leaves" class="form-control m_files">
            </div>
            <div class="col"></div>
            </div>

<br>
            <!-- second row  -->
            <div class="row">
                <div class="col"></div>
                <div class="col-md-4">
                    <label for="email"><i class="fa fa-envelope"></i> Casual Leaves</label>
                    <input type="number" id="c_Leaves" name="email" placeholder="Casual Leaves" class="form-control m_files">
                </div>
                <div class="col-md-4">

                    <label for="adr"><i class="fa fa-address-card-o"></i> Half Day Leaves</label>
                    <input type="number" id="h_leaves" name="address" placeholder="Enter Half Day Leaves" class="form-control m_files">
                </div>
                <div class="col"></div>
                </div>

<br>
                <!-- third row  -->
                <div class="row">
                    <div class="col"></div>
                    <div class="col-md-4">
                        <label for="city"><i class="fa fa-institution"></i> Maternity Leave</label>
                        <input type="number" id="m_Leaves" name="city" placeholder="Enter Maternity Leave" class="form-control m_files">
                    </div>
                    <div class="col-md-4">
                        <label for="state">Paternity Leave</label>
                        <input type="number" id="p_Leaves" name="state" placeholder="Enter Paternity Leave" class="form-control m_files">
                    </div>
                    <div class="col"></div>
                    </div>
               <div class="text-center">
                <i class="fa-sharp fa-solid fa-plus mt-3 mb-3" onclick="empLeaves()"></i>
               </div>
                
            <div class="container text-center mt-3" style="border:none;">
                <button type="button" class="btn btn modal_diss_btn"  data-bs-toggle="modal" data-bs-target="#myModal">View</button>
            </div>
            </div>
           
      
        <br>
    </div>
    <div class="col-sm-2"> </div>
    </div>
    </div>
    </div>
    <div class="container mt-3" style="border: none; background-color: white;">
        <!-- Button to Open the Modal -->
        <!-- The Modal -->
        <div class="modal" id="myModal">
            <div class="modal-dialog modal-fullscreen">
                <div class="modal-content">

                    <!-- Modal Header -->
                    <div class="modal-header">
                        <h4 class="modal-title text-center">Employee Leaves</h4>
                        <button type="button" class="btn-close btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <!-- Modal body -->
                    <div class="modal-body">
                        <input type="text" id="first_Input" class="form-control" placeholder="Search...">
                        <table class="table table-hover" id="dsTable">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Sick Leave</th>
                                    <th>Casual Leave</th>
                                    <th>Half Day Leave</th>
                                    <th>Maternity Leave</th>
                                    <th>Paternity Leave</th>
                                    <th>Total</th>
                                    <th>Balance</th>
                                    <th>Edit</th>
                                    <th>Delete</th>
                                </tr>
                            </thead>
                           
                            <tbody id="myTable">
                                
                            </tbody>
                        </table>
                    </div>
                    <!-- Modal footer -->
                    <div class="modal-footer">
                        <button type="button" class="btn close_btn me-2" data-bs-dismiss="modal">Close</button>
                      </div>
                </div>
            </div>
        </div>
    </div>
    </div>
    <script>




// second method 



const products_arr = [];

function empLeaves() {

            const emp_name = document.getElementById('name').value;
            const s_Leaves = document.getElementById('s_Leaves').value;
            const c_Leaves = document.getElementById('c_Leaves').value;
            const h_leaves = document.getElementById('h_leaves').value;
            const m_Leaves = document.getElementById('m_Leaves').value;
            const p_Leaves = document.getElementById('p_Leaves').value;
            // const edit_btn = `<i class='fas fa-edit' onclick='editRow()'></i>`

            const myTotal = parseInt(s_Leaves) + parseInt(c_Leaves) + parseInt(h_leaves) + parseInt(m_Leaves) +
                parseInt(p_Leaves);
            const y = 14;
            const Balance = y - myTotal;
            // const btn = ` <i class="fa fa-remove "  onclick="deleteRow(this)"></i>`



  let product_object = {
    name_leave: emp_name,
    S_leave: s_Leaves,
    C_leave: c_Leaves,
    H_leave: h_leaves,
    M_leave: m_Leaves,
    P_leave: p_Leaves,
    my_total: myTotal,
    my_balance: Balance,
  
  }

  products_arr.push(product_object);
  refresh_products();
};

function refresh_products() {

  const table_data = document.getElementById('myTable');

  
  const delete_btn = ` <i class="fa fa-remove " onclick="deleteRow(this)"></i>`;

  table_data.innerHTML = '';

  for (item in products_arr) {

    let arr_item = products_arr[item];

    table_data.innerHTML = table_data.innerHTML + `<tr id = 'product_${item}'>
                                                    <td><input id = 'date_1${item}' type='date' disabled value='${arr_item.name_leave}' class='text-center'/></td>
                                                    <td><input id = 'date_2${item}' type='date' disabled value='${arr_item.S_leave}' class='text-center'/></td>
                                                    <td><input id = 'name_3${item}' disabled value='${arr_item.C_leave}' class='text-center'/></td>
                                                    <td><input id = 'unit_4${item}' disabled value='${arr_item.H_leave}'class='text-center' /></td>
                                                    <td><input id = 'qty_5${item}' disabled value='${arr_item.M_leave}'class='text-center' /></td>
                                                    <td><input id = 'qty_6${item}' disabled value='${arr_item.P_leave}'class='text-center' /></td>
                                                    <td><input id = 'qty_7${item}' disabled value='${arr_item.my_total }'class='text-center' /></td>
                                                    <td><input id = 'qty_8${item}'  disabled value='${arr_item.my_balance - arr_item.my_total}'class='text-center' /></td>
                                                    <td id='edit_${item}'><i class="fas fa-edit" onclick='editRow(${item})'></i></td>
                                                    <td>${delete_btn}</td>
                                                  </tr>`;
  }

};
function editRow(tr_id){

let editId = 'edit_'+tr_id;

$('#'+editId).html(`<i class='fas fa-check-circle' onclick='myFunction(${tr_id})'></i>`)

let selectedRow = $('#product_'+tr_id+' input');

selectedRow.prop('disabled', false);

}



function myFunction(product_id){
  let editId = 'edit_'+product_id;
  let emp_name = $('#date_1'+product_id).val();
  let s_Leaves = $('#date_2'+product_id).val();
  let c_Leaves = $('#name_3'+product_id).val();
  let h_leaves = $('#unit_4'+product_id).val();
  let m_Leaves = $('#qty_5'+product_id).val();
  let p_Leaves = $('#qty_6'+product_id).val();
  let total_Leaves = $('#qty_7'+product_id).val();
  let Balance = $('#qty_8'+product_id).val();

 

  let selectedRow = $('#product_'+product_id+' input');


  products_arr[product_id] = {
    name_leave: emp_name,
    S_leave: s_Leaves,
    C_leave: c_Leaves,
    H_leave: h_leaves,
    M_leave: m_Leaves,
    P_leave: p_Leaves,
    my_total: total_Leaves,
    my_balance: Balance,
  }

  $('#'+editId).html(`<i class='fas fa-edit' onclick='editRow(${product_id})'></i>`);
  selectedRow.prop('disabled', true);
  refresh_products();

}


        function deleteRow(row) {
            var d = row.parentNode.parentNode.rowIndex;
            document.getElementById('dsTable').deleteRow(d);
        }



        // Search function of row 
        $(document).ready(function(){
  $("#first_Input").on("keyup", function() {
    var value = $(this).val().toLowerCase();
    $("#myTable tr").filter(function() {
      $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
    });
  });
});

          // javascript for logout function
// Check if the user is logged in
if (!localStorage.getItem('userLoggedIn')) {
    // If not logged in, redirect to login page
    window.location.href = "./index.html";
}

function myLogout () {
    // Remove login state from localStorage
    localStorage.removeItem('userLoggedIn');
    // Redirect to login page
    window.location.href = "./index.html";
}
    </Script>
</body>

</html>